<!doctype html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <title>Tetris VS</title>
    <link href="https://unpkg.com/sanitize.css" rel="stylesheet">
    <link href="https://unpkg.com/sanitize.css/forms.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/css/tetrisVS.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.0.7/vue.min.js"></script>
</head>

<body>
    <header>
        <h1>Tetris VS</h1>
    </header>

    <div id="app">
        <!-- game -->
        <div id="game" v-if="yetReachedAccessLimit">
            <!-- config -->
            <div v-if="!gameStarted">
                <div>
                    <!-- <p>横:<input type="number" v-model="width" min="4" max="25"></p>
                    <p>縦:<input type="number" v-model="height" min="15" max="25"></p> -->
                    <!-- <p>落下間隔（秒）:<input type="number" v-model="speed" min="0.1" max="1.5" step="0.1"></p> -->
                    <p>キーボード操作</p>
                    <p>[移動 ←↓→]<br>[回転 f]<br>[ハードドロップ ↑]<br>[ホールド s]<br>
                        [スタート space]<br>[ポーズ p]<br>[リセット r]</p>
                    <p><input type="button" @click="startFn" value="START"></p>
                    <p v-if="canInvite">招待コード：
                    <input ref="target" id="invitation" v-model="invitation" @click="$refs.target.select()"></p>
                </div>
            </div>
    
            <!-- board -->
            <div v-else="!gameStarted">
                <p><input type="button" @click="resetFn" value="RESET"></p>
                <div class="container center" v-show="!paused">
                    <div class="side">score<br>{{ score }} </div>
                    <div class="side">
                        <div v-for="i in 4" class="container">
                            <div v-for="j in 4" class="blockGrid" :style="{ backgroundColor: color[holdingBlock[i-1][j-1]] }"></div>
                        </div>
                    </div>
                    <div>
                        <div v-for="i in height" class="container">
                            <div v-for="j in width" class="boardGrid" :style="{ backgroundColor: color[board[i-1][j-1]] }"></div>
                        </div>
                    </div>
                    <div class="side">
                        <div v-for="k in 5">
                            <div v-for="i in 4" class="container">
                                <div v-for="j in 4" class="blockGrid" :style="{ backgroundColor: color[comingBlock[k][i-1][j-1]] }"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <p v-if="paused" style="color: red;">PAUSED<br>Press P to restart.</p>
                <p v-if="gameOver" style="color: red;">GAME OVER</p>
            </div>
        </div>

        <!-- chat -->
        <div id="chat" v-if="yetReachedAccessLimit">
            <div id="chatTitle">
                <h3>Chat</h3>
                <div id="chatNotification">New message ↓</div>
            </div>

            
            <div id="chatBoard">
                <ul id="msglist">
                  <li v-bind:class="{ me: message.isMine, others: !message.isMine }" v-for="message in messages">{{ message.msg }}</li>
                </ul>
            </div>
            <div id="chatForm">
                <form id="postform">
                    <input type="text" id="msg" v-model="textInput">
                    <button v-on:click.prevent="sendMessage">Send</button>
                </form>
            </div>

        </div>
        
        <div v-if="!yetReachedAccessLimit">
            <p>This URL has reached access limit. Please create a new game from <a href="/tetrisVS/start">here</a>.</p>

        </div>
    </div>
    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/tetrisVS.js">
    </script>
</body>

</html>